{% extends 'mainapp/appointment_base.html' %}
{% load static %}

{% block url %}{% url 'appointment_step2' %}{% endblock url %}


{% block styles %} 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
{% endblock %}



{% block form %}
{% csrf_token %}
<div class="flex-grow-1">
    {{ form }}
</div>
{% endblock %}

{% block scripts %}
<!-- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Å–∞–º flatpickr -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<!-- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.9/dist/l10n/ru.js"></script>

<script type="module">
    
    
    // –ü–µ—Ä–µ–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–∞—Ç –∫–∞–∫ –º–∞—Å—Å–∏–≤ –≤ JavaScript
    const availableDates = JSON.parse("{{ available_dates|safe }}".replace(/'/g, '"'));
    const minDate = "{{ available_dates|first }}";
    const maxDate = "{{ available_dates|last }}"
    
    flatpickr("#datepicker", {
        enable: availableDates, // –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—Ç—ã
        minDate: minDate, 
        maxDate: maxDate,
        dateFormat: "Y-m-d", // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã –¥–ª—è flatpickr
        locale: {
            ...flatpickr.l10ns.ru,
            firstDayOfWeek: 1,
        },
        onDayCreate: function(dObj, dStr, fp, dayElem) {
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç YYYY-MM-DD
            const date = dayElem.dateObj.toISOString().split('T')[0];
            
        }
    });
</script>
<script>
    document.getElementById("datepicker").placeholder = "–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É              üìÖ";
</script>
{% endblock scripts %}


